#!/bin/sh
#
# This script will plot curves using GMT. If you want to
#use this as a data file for psxy in another script, delete these
# first lines, as well as the last line.
#
/bin/rm -f taup_curve.ps

gmt psbasemap -JX6.0i -P -R0/180/0.0/900.0 -Bxa20+l'Distance (deg)' -Bya100+l'Time (sec)' -BWSne+t'iasp91 (h=0.0 km)' -K > taup_curve.ps
gmt pstext -JX -P -R  -O -K >> taup_curve.ps <<END
16.182093  232.03065 10 0 0 1 P
END

gmt psxy -JX -R -m -O -K >> taup_curve.ps <<END
> P for a source depth of 0.0 kilometers in the iasp91 model
    0.00      0.00
    0.15      2.86
    2.27     43.60
    3.21     61.60
    4.54     87.06
    6.42    123.06
    7.87    150.67
    9.08    173.94
    7.14    136.74
    6.48    124.16
    5.68    108.88
    4.77     91.54
    3.83     73.55
    2.94     56.66
    1.95     38.04
    1.54     30.23
    1.32     26.25
    1.22     24.37
    1.18     23.54
    1.17     23.40
    1.09     21.95
    1.06     21.47
    0.99     20.15
    0.98     19.97
    0.91     18.75
    0.90     18.48
    0.88     18.22
    0.87     17.97
    0.85     17.74
    0.83     17.29
    0.82     17.08
    0.81     16.88
    0.76     16.15
    0.73     15.50
    0.71     15.30
    0.71     15.18
    2.68     48.75
    3.49     62.65
    4.64     82.29
    6.27    110.06
    8.58    149.28
    6.12    107.52
    5.39     95.15
    4.59     81.44
    3.77     67.59
    3.02     54.89
    2.13     39.79
    2.01     37.85
    1.91     36.25
    1.76     33.74
    1.60     30.99
    1.58     30.64
    1.50     29.47
    1.44     28.47
    1.33     26.61
    1.24     25.17
    1.19     24.39
    1.18     24.20
    1.16     24.02
    1.15     23.85
    1.14     23.68
    1.12     23.37
    1.11     23.22
    1.10     23.07
    1.09     22.78
    1.07     22.51
    1.04     22.02
    1.01     21.55
    0.98     21.14
    0.95     20.75
    0.93     20.41
    0.91     20.07
    0.89     19.77
    0.87     19.48
    0.85     19.22
    0.83     18.96
    0.81     18.73
    0.80     18.50
    0.79     18.40
    0.78     18.29
    0.77     18.09
    0.75     17.90
    0.74     17.74
    2.99     48.60
    3.92     61.37
    5.23     79.43
    7.09    104.95
    8.51    124.52
    9.72    141.01
   11.73    168.63
   13.44    191.89
   13.95    198.94
   15.28    217.09
   16.50    233.70
   18.70    263.50
   16.31    231.14
   15.62    221.86
   14.92    212.38
   14.39    205.18
   14.32    204.27
   14.65    208.62
   14.69    209.13
   14.73    209.63
   15.15    215.23
   15.62    221.40
   16.35    230.92
   16.09    227.55
   16.08    227.43
   16.24    229.52
   16.51    232.95
   17.03    239.44
   17.09    240.28
   17.16    241.07
   17.50    245.34
   17.67    247.54
   17.85    249.74
   18.17    253.71
   18.50    257.71
   18.53    258.13
   18.57    258.52
   18.92    262.85
   19.11    265.05
   19.29    267.24
   19.63    271.38
   19.98    275.53
   19.99    275.68
   20.01    275.82
   20.36    280.03
   20.54    282.15
   20.72    284.26
   21.07    288.33
   21.42    292.39
   20.97    287.20
   20.79    285.07
   18.70    261.00
   17.71    249.68
   16.98    241.36
   16.39    234.61
   15.44    223.94
   14.69    215.45
   14.08    208.70
   16.18    232.03
   16.97    240.79
   18.02    252.40
   19.35    266.98
   20.33    277.71
   20.79    282.66
   21.86    294.19
   23.11    307.47
   23.14    307.81
   24.22    319.13
   24.99    327.09
   25.26    329.84
   26.22    339.67
   26.62    343.66
   27.17    349.12
   28.08    358.06
   28.12    358.49
   25.80    335.82
   24.90    327.03
   23.68    315.16
   22.78    306.51
   22.05    299.50
   20.85    287.90
   20.34    283.09
   19.88    278.74
   19.08    271.15
   18.38    264.60
   17.68    258.14
   19.62    276.07
   20.39    283.17
   21.45    292.90
   22.89    306.10
   24.77    323.33
   26.17    336.06
   26.40    338.14
   26.62    340.13
   27.90    351.63
   29.02    361.61
   29.24    363.49
   31.53    383.77
   32.95    396.20
   33.08    397.35
   33.21    398.48
   34.39    408.69
   35.43    417.71
   35.82    421.03
   37.64    436.53
   38.10    440.40
   39.71    453.87
   39.74    454.15
   39.77    454.41
   39.83    454.92
   39.96    455.93
   40.08    456.93
   40.20    457.92
   40.48    460.24
   40.73    462.33
   40.98    464.37
   41.22    466.37
   41.69    470.27
   42.16    474.09
   42.67    478.23
   43.14    482.01
   43.59    485.68
   44.04    489.27
   44.97    496.69
   45.83    503.55
   46.73    510.65
   47.57    517.19
   48.45    524.00
   49.27    530.28
   50.20    537.38
   50.24    537.74
   50.29    538.09
   50.38    538.77
   50.56    540.12
   50.91    542.78
   51.75    549.05
   52.53    554.86
   52.84    557.15
   54.10    566.43
   55.36    575.57
   55.65    577.70
   57.16    588.48
   57.85    593.32
   58.67    599.10
   60.14    609.23
   60.24    609.96
   61.59    619.12
   62.58    625.78
   63.02    628.73
   64.43    638.03
   64.87    640.91
   65.82    647.06
   67.06    655.04
   67.19    655.83
   68.53    664.31
   69.23    668.65
   69.60    670.96
   69.87    672.60
   71.17    680.54
   71.32    681.45
   72.46    688.31
   73.34    693.56
   73.35    693.58
   73.74    695.90
   74.98    703.13
   75.31    705.03
   76.22    710.23
   77.01    714.69
   77.21    715.85
   77.44    717.12
   78.63    723.74
   79.05    726.06
   79.81    730.19
   80.58    734.32
   80.85    735.75
   80.98    736.49
   82.11    742.45
   82.56    744.80
   83.24    748.33
   84.03    752.35
   84.23    753.39
   84.35    753.99
   85.43    759.41
   85.84    761.42
   86.51    764.75
   87.37    768.91
   87.40    769.06
   87.57    769.87
   88.59    774.75
   88.89    776.17
   89.62    779.57
   91.56    788.55
   92.47    792.75
   93.86    799.17
   94.10    800.25
   94.60    802.54
   96.43    810.85
   97.78    816.90
   98.40    819.64
END
# end postscript
gmt psxy -JX -R -m -O -T  >> taup_curve.ps
# convert ps to pdf, clean up .ps file
gmt psconvert -P -Tf  taup_curve.ps && rm taup_curve.ps
# clean up after gmt...
rm gmt.history
